<?xml version="1.0"?>
<robot xmlns:xacro="http://www.ros.org/wiki/xacro" name="protobot">
    <!-- Includes files to build the robot -->
    <xacro:include filename="Base.xacro" />
    <xacro:include filename="Wheel.xacro" />
    <xacro:include filename="material.xacro" />

    <!-- Wheel Origin Values -->
    <xacro:property name="LeftWheelXOrigin" value="-.32"/>
    <xacro:property name="RightWheelXOrigin" value=".32"/>

    <xacro:property name="BackWheelYOrigin" value="-.38"/>
    <xacro:property name="MiddleWheelYOrigin" value="0"/>
    <xacro:property name="FrontWheelYOrigin" value=".38"/>

    <xacro:property name="wheelMass" value="0.7"/>

    <xacro:property name="baseMass" value="20"/>

    <!-- Base of the robot -->
    <xacro:base name="base" mass="${baseMass}"/>

    <!-- Left Side of the wheels -->
    <xacro:wheel name="wheel_Right_Front"  mass="${wheelMass}" parentLink="base_link" WheelXOrigin="${FrontWheelYOrigin}" WheelYOrigin="${LeftWheelXOrigin}"/>
    <xacro:wheel name="wheel_Right_Middle" mass="${wheelMass}" parentLink="base_link" WheelXOrigin="${MiddleWheelYOrigin}" WheelYOrigin="${LeftWheelXOrigin}"/>
    <xacro:wheel name="wheel_Right_Back" mass="${wheelMass}" parentLink="base_link" WheelXOrigin="${BackWheelYOrigin}" WheelYOrigin="${LeftWheelXOrigin}"/>

    <!-- Right Side of the wheels -->
    <xacro:wheel name="wheel_Left_Front" mass="${wheelMass}" parentLink="base_link" WheelXOrigin="${FrontWheelYOrigin}" WheelYOrigin="${RightWheelXOrigin}"/>
    <xacro:wheel name="wheel_Left_Middle" mass="${wheelMass}" parentLink="base_link" WheelXOrigin="${MiddleWheelYOrigin}" WheelYOrigin="${RightWheelXOrigin}"/>
    <xacro:wheel name="wheel_Left_Back" mass="${wheelMass}" parentLink="base_link" WheelXOrigin="${BackWheelYOrigin}" WheelYOrigin="${RightWheelXOrigin}"/>

    <!-- Camera -->

    <xacro:include filename="$(find gnc_gazebo)/sensors/_d435i.xacro" />
    <xacro:include filename="$(find gnc_gazebo)/sensors/_T265.xacro"/>
    <xacro:arg name="use_nominal_extrinsics" default="True" />

    <xacro:realsense_d435 sensor_name="d435i" parent_link="base_link" rate="60.0">
        <origin xyz="0.20 0 0.1805" rpy="0 0 0"/>
    </xacro:realsense_d435>

    <xacro:realsense_T265 sensor_name="t265" parent_link="base_link" rate="60.0">
        <origin rpy="0 0 0" xyz="0 0 0.15"/>
    </xacro:realsense_T265>

    <!-- IMU GPS -->
        <xacro:include filename="$(find gnc_gazebo)/sensors/_zedf9r.xacro"/>
        <xacro:Sparkfun_zedf9r name="zed_Sensor" parentLink="base_link">
            <origin rpy="0 0 0" xyz="0 0 0.15"/>
        </xacro:Sparkfun_zedf9r>

    <!-- Gazebo code for protobot -->
    <gazebo>
        <plugin filename="libgazebo_ros_control.so" name="gazebo_ros_control">
        <robotNamespace>gnc_robot</robotNamespace>
        </plugin>
    </gazebo>
    <gazebo>
        <plugin name="gazebo_ros_joint_state_publisher"
            filename="libgazebo_ros_joint_state_publisher.so">
            <update_rate>20</update_rate>
            <joint_name>wheel_Left_Front_joint</joint_name>
            <joint_name>wheel_Left_Middle_joint</joint_name>
            <joint_name>wheel_Left_Back_joint</joint_name>
            <joint_name>wheel_Right_Front_joint</joint_name>
            <joint_name>wheel_Right_Middle_joint</joint_name>
            <joint_name>wheel_Right_Back_joint</joint_name>
        </plugin>
    </gazebo>
    <gazebo>
        <plugin name="gazebo_ros_joint_pose_trajectory"
            filename="libgazebo_ros_joint_pose_trajectory.so">
            <update_rate>2</update_rate>
        </plugin>
    </gazebo>

    <joint name="teleop_camera_joint" type="fixed">
    <origin xyz="-0.181 0.19 0.695" rpy="0 0 0"/>
    <parent link="base_link"/>
    <child link="teleop_camera_link"/>
    </joint>

    <link name="teleop_camera_link"/>

    <joint name="arm_joint" type="fixed">
        <origin xyz="-0.113 -0.0174 0.235" rpy="0 0 0"/>
        <parent link="base_link"/>
        <child link="arm_link"/>
    </joint>

    <link name="arm_link">
        <visual>
            <origin xyz="0 0 0" rpy="0 0 0"/>
            <geometry>
                <mesh filename="package://gnc_gazebo/mesh/arm.stl"/>
            </geometry>
        </visual>
    </link>

    <link name="base_to_shoulder_link"/>
    <joint name="base_to_shoulder_joint" type="continuous">
	<origin xyz="0 0 0" rpy="0 0 0"/>
	<parent link="base_link"/>
	<child link="base_to_shoulder_link"/>
    </joint>
<!--
    <link name="shoulder_to_arm_link"/>
-->
<!--
    <link name="teleop_camera_link"/>
    <link name="teleop_camera_link"/>
    <link name="teleop_camera_link"/>
-->
    

</robot>
