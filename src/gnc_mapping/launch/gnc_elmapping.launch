<launch>

     <!-- Republish sensor odometry as pose -->
     <node pkg="gnc_mapping" type="republisher.py" name="odom_to_pose_node"/>

     <!-- Downscale pointcloud -->
     <node pkg="nodelet" type="nodelet" name="pcl_manager" args="manager" output="screen" />
     <node pkg="nodelet" type="nodelet" name="voxel_grid" args="load pcl/VoxelGrid pcl_manager" output="screen">
    <remap from="~input" to="/zedm/zed_node/point_cloud/cloud_registered" />
    <remap from="~output" to="/zedm/zed_node/point_cloud/cloud_registered/downsample"/>
    <rosparam>
      filter_field_name: z
      filter_limit_min: 0.01
      filter_limit_max: 10
      filter_limit_negative: False
      leaf_size: 0.02
    </rosparam>
  </node>

   <!-- Elevation mapping node -->
  <node pkg="elevation_mapping" type="elevation_mapping" name="elevation_mapping" output="screen">
    <rosparam command="load" file="$(find gnc_mapping)/config/elevation_mapping/robot.yaml" />
    <rosparam command="load" file="$(find gnc_mapping)/config/elevation_mapping/postprocessor_pipeline.yaml" />
    <rosparam command="load" file="$(find gnc_mapping)/config/elevation_mapping/zed.yaml" />
  </node>

  
  <!-- Visualization -->
  <node pkg="grid_map_visualization" type="grid_map_visualization" name="elevation_map_fused_visualization" output="screen">
    <param name="grid_map_topic" value="/elevation_mapping/elevation_map" />
    <rosparam command="load" file="$(find gnc_mapping)/config/elevation_mapping/visualization/fused.yaml" />
  </node>

  <node pkg="grid_map_visualization" type="grid_map_visualization" name="elevation_map_raw_visualization" output="screen">
    <param name="grid_map_topic" value="/elevation_mapping/elevation_map_raw" />
    <rosparam command="load" file="$(find gnc_mapping)/config/elevation_mapping/visualization/raw.yaml" />
  </node>

</launch>
